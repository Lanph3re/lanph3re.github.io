---
layout: post
cover: 'assets/images/cover8.jpg'
navigation: true
title: 백준11689 - GCD(n, k) = 1
date: 2019-02-09
tags: 백준 알고리즘 c++
subclass: 'post'
logo: 'assets/images/ghost.png'
author: lanphere
categories: lanphere
disqus: true
---

<div class="headline" style="margin-bottom: 25px; border-bottom: 1px dotted rgb(228, 233, 240); color: rgb(51, 51, 51);"
  open="" sans",="" "apple="" sd="" gothic="" neo" ,="" "noto="" sans="" cjk="" kr" ,="" 나눔바른고딕,="" 나눔고딕,=""
  맑은고딕,="" "helvetica="" neue" ,="" helvetica,="" arial,=""="" font-size:="" 13px;="" border-radius:="" 0px=""
  !important;"="">
  <h2
    style="font-weight: normal; line-height: 33px; color: rgb(88, 95, 105); margin-top: 0px; margin-bottom: -2px; font-size: 22px; text-shadow: none; padding-bottom: 5px; display: inline-block; border-bottom: 2px solid rgb(0, 118, 192); border-radius: 0px !important;"
    open="" sans",="" "apple="" sd="" gothic="" neo" ,="" "noto="" sans="" cjk="" kr" ,="" 나눔바른고딕,="" 나눔고딕,=""
    맑은고딕,="" "helvetica="" neue" ,="" helvetica,="" arial,="" sans-serif="" !important;"="">문제</h2>
</div>
<div id="problem_description" open="" sans",="" "apple="" sd="" gothic="" neo" ,="" "noto="" sans="" cjk="" kr" ,=""
  나눔바른고딕,="" 나눔고딕,="" 맑은고딕,="" "helvetica="" neue" ,="" helvetica,="" arial,=""="" font-size:="" medium;=""
  line-height:="" 30px;="" border-radius:="" 0px="" !important;"="">
  <p style="color: rgb(85, 85, 85); border-radius: 0px !important;">자연수 n이 주어졌을 때, GCD(n, k) = 1을 만족하는 자연수 1 ≤ k ≤ n 의
    개수를 구하는 프로그램을 작성하시오.</p>
  <div class="headline"
    style="color: rgb(51, 51, 51); margin-top: 10px; margin-bottom: 25px; border-bottom: 1px dotted rgb(228, 233, 240);"
    open="" sans",="" "apple="" sd="" gothic="" neo" ,="" "noto="" sans="" cjk="" kr" ,="" 나눔바른고딕,="" 나눔고딕,=""
    맑은고딕,="" "helvetica="" neue" ,="" helvetica,="" arial,=""="" font-size:="" 13px;="" border-radius:="" 0px=""
    !important;"="">
    <h2
      style="font-weight: normal; line-height: 33px; color: rgb(88, 95, 105); margin-top: 0px; margin-bottom: -2px; font-size: 22px; text-shadow: none; padding-bottom: 5px; display: inline-block; border-bottom: 2px solid rgb(0, 118, 192); border-radius: 0px !important;"
      open="" sans",="" "apple="" sd="" gothic="" neo" ,="" "noto="" sans="" cjk="" kr" ,="" 나눔바른고딕,="" 나눔고딕,=""
      맑은고딕,="" "helvetica="" neue" ,="" helvetica,="" arial,="" sans-serif="" !important;"="">입력</h2>
  </div>
  <div id="problem_input" open="" sans",="" "apple="" sd="" gothic="" neo" ,="" "noto="" sans="" cjk="" kr" ,=""
    나눔바른고딕,="" 나눔고딕,="" 맑은고딕,="" "helvetica="" neue" ,="" helvetica,="" arial,=""="" line-height:="" 30px;=""
    border-radius:="" 0px="" !important;"="">
    <p style="color: rgb(85, 85, 85); border-radius: 0px !important;">첫째 줄에 자연수 n (1 ≤ n ≤ 10<span
        style="position: relative; font-size: 12px; line-height: 0; vertical-align: baseline; top: -0.5em; border-radius: 0px !important;">12</span>)이
      주어진다.</p>
    <div class="headline"
      style="color: rgb(51, 51, 51); margin-top: 10px; margin-bottom: 25px; border-bottom: 1px dotted rgb(228, 233, 240);"
      open="" sans",="" "apple="" sd="" gothic="" neo" ,="" "noto="" sans="" cjk="" kr" ,="" 나눔바른고딕,="" 나눔고딕,=""
      맑은고딕,="" "helvetica="" neue" ,="" helvetica,="" arial,=""="" font-size:="" 13px;="" border-radius:="" 0px=""
      !important;"="">
      <h2
        style="font-weight: normal; line-height: 33px; color: rgb(88, 95, 105); margin-top: 0px; margin-bottom: -2px; font-size: 22px; text-shadow: none; padding-bottom: 5px; display: inline-block; border-bottom: 2px solid rgb(0, 118, 192); border-radius: 0px !important;"
        open="" sans",="" "apple="" sd="" gothic="" neo" ,="" "noto="" sans="" cjk="" kr" ,="" 나눔바른고딕,="" 나눔고딕,=""
        맑은고딕,="" "helvetica="" neue" ,="" helvetica,="" arial,="" sans-serif="" !important;"="">출력</h2>
    </div>
    <div id="problem_output" open="" sans",="" "apple="" sd="" gothic="" neo" ,="" "noto="" sans="" cjk="" kr" ,=""
      나눔바른고딕,="" 나눔고딕,="" 맑은고딕,="" "helvetica="" neue" ,="" helvetica,="" arial,=""="" line-height:="" 30px;=""
      border-radius:="" 0px="" !important;"="">
      <p style="color: rgb(85, 85, 85); border-radius: 0px !important;">GCD(n, k) = 1을 만족하는 자연수 1 ≤ k ≤ n 의 개수를 출력한다.
      </p>
      <p style="color: rgb(85, 85, 85); border-radius: 0px !important;"><br></p>
      <p style="color: rgb(85, 85, 85); border-radius: 0px !important;"><span>문제는 단순한데 입력의 범위가
          큰 편이여서 시간초과 때문에 애를 많이 먹었다.</span></p>
      <p style="color: rgb(85, 85, 85); border-radius: 0px !important;"><span>처음 접근법은 1부터 n까지의
          모든 수에 대해서 n과 유클리드 알고리즘으로 GCD를 구해서 1인지 아닌지 판별하는 방법을 생각했다. 지금 생각해보니 너무 단순했던 것 같다. 이 문제를 풀기 위해선 소인수 분해 알고리즘과 오일러
          피함수의 개념을 알 필요가 있다.</span></p>
      <h3 style="color: rgb(85, 85, 85); border-radius: 0px !important;">소인수분해 알고리즘</h3>
      <p style="color: rgb(85, 85, 85); border-radius: 0px !important;"><span>소인수분해는 어떤 수를 소수인
          인수로 나누는 것이다. 그래서 그 정의에 충실해서 코드를 다음과 같이 짤 수 있다.</span></p>
      <pre style="border-radius: 0px !important;"><font color="#555555"><code><span>int main () {
  int n = 32;
  queue<int> queue;

  for (int i = 2; i < n; i++) {
    while (n % i == 0) {
      n /= i;
      queue.push(i);
    }
  }

  return 0;
}<br></span></font></code></pre>
    </div>
  </div>
</div><span>하지만 이렇게 코드를 짜면 시간복잡도가 n이기 때문에 비효율적이다. 최적화를 시켜보자.</span>
<p></p>
<p><span>어떤 수 n이 있다고 하자. 만약 n이 어떤 두 소수의 곱으로 이루어져 있다고 하면, 즉 n = p * q
    (단, p와 q는 소수)이면</span></p>
<p><span>p와 q중 하나는 n의 제곱근보다 크거나 작고, 나머지 하나는 n의 제곱근보다 작거나 같다. 따라서 이
    사실을 이용하면</span></p>
<p><span>for문의 범위의 크기를 n으로 하지않고 sqrt(n)으로 최적화 시킬 수 있다. 적용한 코드는 다음과
    같다.</span></p>
<pre><code><span>int main () {
  int n = 32;
  int rt = (int)sqrt(n);
  queue<int> queue;

  for (int i = 2; i <= rt; i++) {
    while (n % i == 0) {
      n /= i;
      queue.push(i);
    }
  }
  if (n > 1) queue.push(n);

  return 0;
}</span><font face="NanumSquare"><span><br></span></font></code></pre><span>for문에서 sqrt(n)까지만 인수를 찾기 때문에 애초에 n이 소수였으면
  for문에서 걸러지지 않는다. 따라서 아래의
  if문이 추가됐다.</span>
<br><span>소인수 분해 알고리즘과 오일러 피 함수 공식을 같이 이용해서 작성한 코드이다.</span></p>
<pre style="margin-top: 0.5em; margin-bottom: 0.5em; line-height: inherit;"><font color="#222222"><code><span>int main () {
  long long n, 
            cur_factor,
            result,
            rt,
            k = 2;
  cin >> n;
  if (n == 1) {
    cout << 1 << endl;
    return 0;
  }

  cur_factor = -1;
  result = n;
  rt = (long long)sqrt(n);
  /* prime factorization */
  for (long long i = 2; i <= rt; i++)
    while (n % i == 0) {
      n /= i;
      if (cur_factor != i) {
        cur_factor = i;
        result /= i;
        result *= (i - 1);
      }
    }
  if (n > 1) {
    result /= n;
    result *= (n - 1);
  }    
  cout << result << endl;
  return 0;
}</span></font><font color="#222222" face="NanumSquare"><span><br></span></font></code></pre>